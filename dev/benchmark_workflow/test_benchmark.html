
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Testing a benchmark &#8212; benchopt 1.7.1.dev10 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=974f4921" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=0e427a50"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'benchmark_workflow/test_benchmark';</script>
    <link rel="icon" href="../_static/logo_benchopt.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configure Benchopt" href="config_benchopt.html" />
    <link rel="prev" title="Write a benchmark" href="write_benchmark.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_benchopt.png" class="logo__image only-light" alt="benchopt logo"/>
    <script>document.write(`<img src="../_static/logo_benchopt.png" class="logo__image only-dark" alt="benchopt logo"/>`);</script>
  
  
    <p class="title logo__title">1.7.1.dev10</p>
  
</a></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Benchopt
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../get_started.html">Get started</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Benchmark workflow</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install_benchmark.html">Install a benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_benchmark.html">Run a benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualize_benchmark.html">Visualize a benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="manage_benchmark_results.html">Manage benchmark results</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_benchmark.html">Write a benchmark</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Testing a benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_benchopt.html">Configure Benchopt</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/build_benchmark.html">Understanding and building a simple benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/add_solver.html">Add a solver to an existing benchmark</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/index.html">User guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user_guide/API_ref.html">API references</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.BaseObjective.html">benchopt.BaseObjective</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.BaseDataset.html">benchopt.BaseDataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.BaseSolver.html">benchopt.BaseSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.run_benchmark.html">benchopt.run_benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.safe_import_context.html">benchopt.safe_import_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.plotting.plot_benchmark.html">benchopt.plotting.plot_benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.datasets.simulated.make_correlated_data.html">benchopt.datasets.simulated.make_correlated_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/generated/benchopt.utils.profile.html">benchopt.utils.profile</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/CLI_ref.html">Command line interface (CLI) references</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/advanced.html">Advanced usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/ml_benchmark.html">Setting up an ML benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/performance_curves.html">Performance curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/tweak_datasets.html">Tweak a dataset</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../available_benchmarks.html">Available benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What’s new</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/benchopt/benchopt" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Testing a benchmark</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-options-with-cli-flags">Specifying options with CLI flags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skipping-or-xfailing-some-tests">Skipping or xfailing some tests</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="testing-a-benchmark">
<span id="test-benchmark"></span><h1>Testing a benchmark<a class="headerlink" href="#testing-a-benchmark" title="Link to this heading">#</a></h1>
<p>To help maintaining the benchmark, <code class="docutils literal notranslate"><span class="pre">benchopt</span></code> provides utilities to test that
it can be run properly.</p>
<p>The tests are based on <code class="docutils literal notranslate"><span class="pre">pytest</span></code>, and can be run with the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">benchopt<span class="w"> </span><span class="nb">test</span><span class="w"> </span>.</span>
</pre></div></div><p>This command will run a series of tests to check that the benchmark’s components
are compatible with <code class="docutils literal notranslate"><span class="pre">benchopt</span></code> and working as expected.
The tests include:</p>
<ul class="simple">
<li><p>Checking that all datasets have the proper API and can be loaded.</p></li>
<li><p>Checking that the objective have the proper API and can be computed on the <code class="docutils literal notranslate"><span class="pre">simulated</span></code> dataset.</p></li>
<li><p>Checking that all solvers have the proper API and can be run on the <code class="docutils literal notranslate"><span class="pre">simulated</span></code> dataset.</p></li>
<li><p>Checking that all solvers can be installed in a fresh environment.</p></li>
</ul>
<p>The tests that are run can be found in the <a class="reference internal" href="tests.html#benchopt-run-tests"><span class="std std-ref">Benchopt Test definition</span></a>.</p>
<p>By default, if the benchmark has been created using one of our templates (see XXX), the repo contains some github actions that will try to run these tests on each push/pull request, and once a week, to ensure long term maintainability.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The scheduling of the github action run can be changed in
<code class="docutils literal notranslate"><span class="pre">.github/workflows/main.yml</span></code>.</p>
</div>
<section id="specifying-options-with-cli-flags">
<span id="pytest-option"></span><h2>Specifying options with CLI flags<a class="headerlink" href="#specifying-options-with-cli-flags" title="Link to this heading">#</a></h2>
<p>It is possible to pass various options to the <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code> command,
to customize how the tests are run, in particular in which environment
the tests are executed and in which environment the installation tests are run.</p>
<p>For this command, there are two layers of options that can be specified: the <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code> command is a wrapper around the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command,
and some options can be passed to <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code>, while others are passed to
the underlying <code class="docutils literal notranslate"><span class="pre">pytest</span></code>. When an option from <code class="docutils literal notranslate"><span class="pre">pytest</span></code> is not recognized, and needs to be passed explicitely to the underlying command, it must be separated from the <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code> options by a <code class="docutils literal notranslate"><span class="pre">--</span></code>.</p>
<p>First, the <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code> command accepts a <code class="docutils literal notranslate"><span class="pre">--env-name</span></code> flag to specify
in which conda environment the tests should be run. If it is not provided, the
test are run in the current environment. If provided, the environment is created
if it does not exist yet and is also used for the installation tests.</p>
<p>Second, extra arguments can be passed to the underlying <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command.
Classical <code class="docutils literal notranslate"><span class="pre">pytest</span></code> options such as <code class="docutils literal notranslate"><span class="pre">-k</span></code> to only run tests that match a given expression, or <code class="docutils literal notranslate"><span class="pre">-vs</span></code> for  a more verbose output, can be used.
We also provide extra options for the tests that are run in <code class="docutils literal notranslate"><span class="pre">benchopt</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--test-env=TEST_ENV</span></code>: This option is used to specify an environment in
which the installation tests are run. By default, a fresh environment is
created for these tests with each run of the <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code> command.
Specifying an environment name here will reuse this environment for next runs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--skip-install</span></code>: Skip test that tries to install solvers. These tests are
typically slow even when the solvers are installed, which might make it
complicated to debug some particular issues.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--recreate</span></code>: This option forces the recreation of the environment used for
installation tests even if it already exists.</p></li>
</ul>
</section>
<section id="skipping-or-xfailing-some-tests">
<h2>Skipping or xfailing some tests<a class="headerlink" href="#skipping-or-xfailing-some-tests" title="Link to this heading">#</a></h2>
<p>In some cases, certain solvers or datasets may not be easily testable on a
continuous integration (CI) service. This is typically the case for very large
datasets, or solvers that require a GPU.
In this case, the tests can be configured to be skipped or marked as expected
to fail (xfailed) for the <code class="docutils literal notranslate"><span class="pre">benchopt</span> <span class="pre">test</span></code> command.
This can be done by modifying the <code class="docutils literal notranslate"><span class="pre">test_config.py</span></code> file, located in the root
folder of the benchmark, and adding a function that skip specific configurations.</p>
<p>For instance, in order to skip the test <code class="docutils literal notranslate"><span class="pre">test_solver_install</span></code> for the solver
<code class="docutils literal notranslate"><span class="pre">solver1</span></code> which is defined in the benchmark, one can add the following
function to the <code class="docutils literal notranslate"><span class="pre">test_config.py</span></code> file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_test_solver_install</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">solver</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;solver1&quot;</span><span class="p">:</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Skipping test_solver_install for solver1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;solver2&quot;</span><span class="p">:</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="s2">&quot;Known installation error for solver2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="write_benchmark.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Write a benchmark</p>
      </div>
    </a>
    <a class="right-next"
       href="config_benchopt.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Configure Benchopt</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-options-with-cli-flags">Specifying options with CLI flags</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skipping-or-xfailing-some-tests">Skipping or xfailing some tests</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Benchopt contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>


<script>
fetch("../../versions.json")
  .then(response => response.json())
  .then(data => {
    const select = document.createElement("select");
    select.id = "version-select";
    const header_buttons = document.getElementsByClassName("article-header-buttons")[0];
    header_buttons.insertBefore(select, header_buttons.firstChild);
    const current = window.location.pathname.split('/')[1];  // e.g. "dev" or "v1.2"

    // Stable and dev first
    ["stable", "dev"].forEach(name => {
      const opt = document.createElement("option");
      opt.value = name;
      opt.text = name;
      if (current === name) opt.selected = true;
      select.appendChild(opt);
    });

    // Then all versions
    data.versions.forEach(v => {
      const opt = document.createElement("option");
      opt.value = v;
      opt.text = v;
      if (current === v) opt.selected = true;
      select.appendChild(opt);
    });

    select.onchange = function() {
      window.location.href = window.location.href.replace(current, select.value);
    };
  });
</script>


  <footer class="bd-footer">
  </footer>

  </body>
</html>